<style>
    @import url('https://fonts.googleapis.com/css2?family=Whackadoo&display=swap');
    .pc { display: flex; flex-wrap: wrap; gap: 20px; justify-content: space-between; font-family: 'Whackadoo', 'Arial', sans-serif; }
    .hamster4 { flex: 1; min-width: 300px; background: #fdfdfd; border: 1px solid #eee; border-radius: 8px; padding: 10px; }
    .hamster { display: flex; flex-direction: column; margin-bottom: 8px; }
    .hamster label { font-size: 0.75em; font-weight: bold; text-transform: uppercase; color: #777; }
    .gn-inp { border: 1px solid #ccc; font-size: 0.9em; background: #fff; font-family: inherit; padding: 4px; border-radius: 4px; }
    #litter-box { background: #fff; font-family: 'Whackadoo', sans-serif; }
    .offspring-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 20px; margin-top: 20px; }
    .hamster2 { border: 2px solid #e2e8f0; border-radius: 12px; background: #ffffff; font-size: 0.85em; overflow: hidden; transition: transform 0.2s; }
    .hamster2:hover { transform: translateY(-5px); border-color: #b45309; }
    .img-placeholder { width: 100%; height: 150px; background: #f1f5f9; display: flex; align-items: center; justify-content: center; border-bottom: 1px solid #e2e8f0; color: #94a3b8; font-size: 0.8em; }
    .card-content { padding: 12px; }
    .pnm { font-weight: bold; color: #b45309; display: block; font-size: 1.1em; }
    .pgn { font-size: 0.8em; color: #64748b; display: block; font-family: inherit; background: #f8fafc; padding: 4px; margin: 4px 0; border-radius: 4px; }
    .pdsc { font-style: italic; color: #555; border-top: 1px dashed #cbd5e1; margin-top: 8px; padding-top: 4px; }
    .wrnbnnr { font-weight: bold; display: none; text-align: center; background: #fee2e2; color: #991b1b; padding: 10px; border-radius: 6px; margin-bottom: 15px; }
</style>

<div class="pc">
    <div class="hamster4">
        <h3>Father (Male)</h3>
        <div class="hamster"><label>Color 1</label><select class="gn-inp base-sel" id="dad-1"></select></div>
        <div class="hamster"><label>Color 2</label><select class="gn-inp base-sel blankable" id="dad-2"></select></div>
        <div class="hamster"><label>Color 3</label><select class="gn-inp base-sel blankable" id="dad-3"></select></div>
        <div class="hamster"><label>Coat</label><select class="gn-inp coat-sel" id="dad-coat"></select></div>
        <div class="hamster"><label>Pattern</label><select class="gn-inp pat-sel" id="dad-pat"></select></div>
        <div class="hamster"><label>Umbrous</label><select class="gn-inp" id="dad-u"><option value="uu">Non-Umbrous</option><option value="Uu">Yes (Uu)</option></select></div>
    </div>
    <div class="hamster4">
        <h3>Mother (Female)</h3>
        <div class="hamster"><label>Color 1</label><select class="gn-inp base-sel" id="mom-1"></select></div>
        <div class="hamster"><label>Color 2</label><select class="gn-inp base-sel blankable" id="mom-2"></select></div>
        <div class="hamster"><label>Color 3</label><select class="gn-inp base-sel blankable" id="mom-3"></select></div>
        <div class="hamster"><label>Coat</label><select class="gn-inp coat-sel" id="mom-coat"></select></div>
        <div class="hamster"><label>Pattern</label><select class="gn-inp pat-sel" id="mom-pat"></select></div>
        <div class="hamster"><label>Umbrous</label><select class="gn-inp" id="mom-u"><option value="uu">No</option><option value="Uu">Yes (Uu)</option></select></div>
    </div>
</div>

<div id="litters">
    <div id="lethal-banner" class="wrnbnnr">LETHAL TRAIT DETECTED: Homozygous embryos (DsDs, LgLg, WhWh) failed to develop.</div>
    <div id="offspring-grid" class="offspring-grid"></div>
</div>

<script>
const colors = [
    { val: "++", text: "Golden (++)" }, { val: "aa", text: "Black (aa)" }, { val: "ee", text: "Black Eyed Cream (ee)" }, 
    { val: "pp", text: "Cinnamon (pp)" }, { val: "cdcd", text: "Dark Eared White (cdcd)" }, { val: "dgdg", text: "Dark Grey (dgdg)" },
    { val: "cece", text: "Extreme Dilute (cece)" }, { val: "Lglg", text: "Light Grey (Lglg)" }, { val: "bb", text: "Rust (bb)" }, 
    { val: "SgSg", text: "Silver Grey (SgSg)" }, { val: "ToTo", text: "Yellow (ToTo/ToY)" }
];

const textures = [
    { val: "++", text: "Shorthair (++)" }, { val: "ll", text: "Longhair (ll)" }, 
    { val: "rxrx", text: "Rex (rxrx)" }, { val: "Sasa", text: "Satin (Sasa)" }, { val: "hrhr", text: "Hairless (hrhr)" }
];

const markings = [
    { val: "n", text: "Patternless" }, { val: "Ba", text: "Banded (Ba)" }, { val: "Ds", text: "Dominant Spot (Ds)" }, 
    { val: "rdrd", text: "Recessive Dappled (rdrd)" }, { val: "Wh", text: "Roan/White Bellied (Wh)" }, { val: "ss", text: "Piebald (ss)" }
];

const library = [
    { id: "bbdgdg", name: "Beige" }, { id: "bbLglg", name: "Black Eyed Blonde" }, { id: "bbTo", name: "Black Eyed Honey" },
    { id: "dgdgee", name: "Black Eyed Ivory" }, { id: "eeLglg", name: "Black Eyed Ivory" }, { id: "eeSgsg", name: "Black Eyed Ivory" },
    { id: "eeSgSg", name: "Black Eyed White" }, { id: "Lglgpp", name: "Blonde" }, { id: "ppSgSg", name: "Blonde (Sg var.)" },
    { id: "dgdgeeppU_", name: "Blue Mink" }, { id: "aabbpp", name: "Champagne" }, { id: "aabb", name: "Chocolate" },
    { id: "bbeeU_", name: "Chocolate (Sable var.)" }, { id: "bbeeppU_", name: "Copper" }, { id: "dgdgeeU_", name: "Dark Grey Sable" },
    { id: "aaSg", name: "Dingy Black" }, { id: "aapp", name: "Dove" }, { id: "cdcdpp", name: "Flesh Eared White" },
    { id: "ppTo", name: "Honey" }, { id: "eeLglgU_", name: "Light Grey Sable" }, { id: "dgdgpp", name: "Lilac" },
    { id: "dgdgppTo", name: "Lilac Pearl" }, { id: "eeppU_", name: "Mink (Caramel)" }, { id: "bbee", name: "Pale Eared Cream" },
    { id: "eepp", name: "Red Eyed Cream" }, { id: "dgdgeepp", name: "Red Eyed Ivory" }, { id: "eeLglgpp", name: "Red Eyed Ivory" },
    { id: "eeppSgsg", name: "Red Eyed Ivory" }, { id: "eeU_", name: "Sable" }, { id: "eeSgSgU_", name: "Silver Sable" },
    { id: "dgdgTo", name: "Smoke Pearl" }, { id: "aaTo", name: "Yellow Black" }
];

function f() {
    document.querySelectorAll('.base-sel').forEach(k => {
        if(k.classList.contains('blankable')) k.add(new Option("None", "++"));
        colors.forEach(v => k.add(new Option(v.text, v.val)));
    });
    document.querySelectorAll('.coat-sel').forEach(k => textures.forEach(v => k.add(new Option(v.text, v.val))));
    document.querySelectorAll('.pat-sel').forEach(k => {
        markings.forEach(v => k.add(new Option(v.text, v.val)));
        if (k.id.includes('mom')) k.add(new Option("Tortoiseshell (ToTo)", "ToTo"));
    });
}

function g(s) {
    if (s === "++" || s === "n" || s === "" || s === "uu") return ["+", "+"];
    if (s === "ToTo" || s === "ToY") return ["To", "To"];
    if (s === "Lglg") return ["Lg", "lg"];
    if (s === "SgSg") return ["Sg", "Sg"];
    if (s === "Sasa") return ["Sa", "+"];
    if (s === "Ba") return ["Ba", "n"];
    if (s === "Ds") return ["Ds", "n"];
    if (s === "Wh") return ["Wh", "n"];
    if (s === "Uu") return ["U", "u"];
    if (s.length === 2 && s[0] === s[1]) return [s[0], s[1]];
    if (s.length === 4) return [s.substring(0,2), s.substring(2,4)];
    return [s, s];
}

function h(s1, s2) {
    const x = g(s1);
    const y = g(s2);
    return [x[Math.floor(Math.random()*2)], y[Math.floor(Math.random()*2)]].sort();
}

function k() {
    const k_grid = document.getElementById('offspring-grid');
    k_grid.innerHTML = '';
    const k_banner = document.getElementById('lethal-banner');
    k_banner.style.display = 'none';

    const go = (s) => document.getElementById(s).value;
    const sire = { b: [go('dad-1'), go('dad-2'), go('dad-3')], c: go('dad-coat'), p: go('dad-pat'), u: go('dad-u') };
    const dam = { b: [go('mom-1'), go('mom-2'), go('mom-3')], c: go('mom-coat'), p: go('mom-pat'), u: go('mom-u') };

    for (let i = 0; i < 16; i++) {
        let lethal = false;
        let ys = []; let xs = [];
        
        const dp = h(sire.p, dam.p);
        if (dp.join('') === "DsDs" || dp.join('') === "WhWh") lethal = true;
        xs.push(...dp.filter(v => v !== "n" && v !== "+"));

        const rs = ["aa", "ee", "pp", "cdcd", "dgdg", "cece", "bb", "rdrd", "ss", "ll", "rxrx", "hrhr"];
        rs.forEach(s => {
            const v1 = (sire.b.includes(s) || sire.c === s || sire.p === s) ? s : "++";
            const v2 = (dam.b.includes(s) || dam.c === s || dam.p === s) ? s : "++";
            const pair = h(v1, v2);
            if (pair[0] === pair[1] && pair[0] !== "+") ys.push(pair[0] + pair[1]);
        });

        const sg = h(sire.b.includes("SgSg") ? "SgSg" : "++", dam.b.includes("SgSg") ? "SgSg" : "++");
        if (sg.includes("Sg")) ys.push(sg[0] === sg[1] ? "SgSg" : "Sgsg");

        const lg = h(sire.b.includes("Lglg") ? "Lglg" : "++", dam.b.includes("Lglg") ? "Lglg" : "++");
        if (lg.join('') === "LgLg") lethal = true;
        if (lg.includes("Lg")) ys.push("Lglg");

        const satin = h(sire.c === "Sasa" ? "Sasa" : "++", dam.c === "Sasa" ? "Sasa" : "++");
        if (satin.includes("Sa")) ys.push("Sasa");

        const u = h(sire.u, dam.u);
        if (u.includes("U")) ys.push("U_");

        let male = Math.random() > 0.5;
        let s_code = ""; let s_name = "";
        const m_to = dam.b.includes("ToTo") || dam.p === "ToTo" ? ["To", "To"] : (dam.p === "Toto" ? ["To", "+"] : ["+", "+"]);
        const d_to = sire.b.includes("ToTo") ? ["To", "Y"] : ["+", "Y"];
        const p1 = m_to[Math.floor(Math.random()*2)];
        const p2 = d_to[Math.floor(Math.random()*2)];

        if (male) { if (p1 === "To") { s_code = "ToY"; ys.push("To"); s_name = "Yellow "; } }
        else {
            if (p1 === "To" && p2 === "To") { s_code = "ToTo"; ys.push("To"); s_name = "Yellow "; }
            else if (p1 === "To" || p2 === "To") { s_code = "Toto"; s_name = "Tortoiseshell "; }
        }

        if (lethal) { k_banner.style.display = 'block'; continue; }

        let s_base = "Golden (++)";
        if (ys.includes("cdcd")) { s_base = "Dark Eared White"; s_name = ""; }
        else {
            let v = library.sort((a,b) => b.id.length - a.id.length).find(v => (ys.join('') + s_code).includes(v.id.replace('To','')));
            if (v) s_base = v.name;
        }

        let s_fur = "";
        if (ys.includes("hrhr")) s_fur = "Hairless";
        else {
            let as = ys.filter(v => ["ll", "rxrx", "Sasa"].includes(v));
            s_fur = (as.length > 0 ? as.map(v => textures.find(t => t.val === v || (v === "Sasa" && t.val === "Sasa")).text).join(", ") : "Shorthair");
        }

        const s_mark = xs.length > 0 ? markings.filter(v => xs.includes(v.val)).map(v => v.text).join(" ") : "Solid";

        k_grid.innerHTML += `<div class="hamster2"><div class="img-placeholder">PHOTO</div><div class="card-content">
            <span class="pnm">${s_name}${s_base} ${s_mark}</span>
            <span class="pgn">${ys.join('') + s_code + xs.join('')}</span>
            <strong>Sex:</strong> ${male ? "Male" : "Female"}<br><strong>Coat:</strong> ${s_fur}<br>
            <div class="pdsc">Phenotype description pending...</div></div></div>`;
    }
}
window.onload = () => { f(); document.querySelectorAll('.gn-inp').forEach(e => e.onchange = k); k(); };
</script>